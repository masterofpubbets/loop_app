update tblild

set Loop_Name=REPLACE(loop_name, ' ','')

GO

UPDATE [tblILD]

set [Item_Type]='IC: '+ IC_Type

FROM(

   SELECT tblILD.tbl_id, tblILD.Item_Type, v.IC_Type

   FROM tblILDWITH (NOLOCK)

   INNERJOIN(

       SELECT

        max([tbl_id])as ID,

        IC_Type

       FROM

       (

       SELECT

        ROW_NUMBER()OVER(ORDERBY [Item]ASC)AS RowNo

       ,[Loop_Name],[Item_Type],[tbl_id],[Item],IC_Type

       FROM

       (

       Select vILD.[tbl_id],[Loop_Name],[Item],[Item_Type],vILD.IC_Type

       from

        (

       Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type],tblInsCableList.IC_Type

       from tblILD

       innerjoin tblInsCableList

       on [tblILD].[Item]=tblInsCableList.IC_ID

       where [tblILD]. Item_Typeisnull

       )as vILD

       )as vILDINSC01

       )as vILDINSC

       groupby [Item],IC_Type

   )AS V

   ON v. ID= tbl_id

)AS UpdateV

GO

UPDATE v

set [Item_Type]= 'EQ: ' + [Type]

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type],

tblElectricalEquipment.[Type]

from tblILD

innerjoin tblElectricalEquipment

on [tblILD].[Item]=tblElectricalEquipment.tag

where [tblILD]. Item_Typeisnull

)as V

GO

UPDATE v

set [Item_Type]= 'IQ: ' + [Type]

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type],

tblInsEquipment.[Type]

from tblILD

innerjoin tblInsEquipment

on [tblILD].[Item]=tblInsEquipment.tag

where [tblILD]. Item_Typeisnull

)as V

GO

UPDATE v

set [Item_Type]= 'EC: ' + EC_Type

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type],

tblEleCableList.EC_Type

from tblILD

innerjoin tblEleCableList

on [tblILD].[Item]=tblEleCableList.EC_ID

where [tblILD]. Item_Typeisnull

and tblEleCableList.EC_Type= 'Ins Powersupply'

)as V

GO

UPDATE v

set [Item_Type]= 'Ins JB'

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type]

from tblILD

innerjoin JunctionBox

on [tblILD].[Item]=JunctionBox.JunctionBox

where [tblILD]. Item_Typeisnull

)as V

GO

UPDATE v

set [Item_Type]= 'Ele JB'

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type]

from tblILD

innerjoin tblEleJunctionBox

on [tblILD].[Item]=tblEleJunctionBox.tag

where [tblILD]. Item_Typeisnull

)as V

GO

UPDATE v

set [Item_Type]='Motor'

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type]

from tblILD

innerjoin tblMotor

on [tblILD].[Item]=tblMotor.tag

where [tblILD]. Item_Typeisnull

)as V

GO

UPDATE v

set [Item_Type]= 'INS: ' + Furnished_By+' '+ [Ins Type]

FROM

(

Select [tblILD].[tbl_id],[Loop_Name],[Item],[Item_Type],

CASEWHEN Furnished_ByISNULLTHEN'TR'ELSE Furnished_ByENDAS Furnished_By,

CASEWHEN tblInstruments. InstrumentISNULLTHEN'Accessory'ELSE tblInstruments. InstrumentENDAS [Ins Type]

from tblILD

innerjoin tblInstruments

on [tblILD].[Item]=tblInstruments.Instrument_Tag

where [tblILD]. Item_Typeisnull

and instrument='instrument'

)as V

GO

 

DeleteFROM tblILDWHERE itemnotLIKE'%[0-9]%'

DeleteFROM tblildWHERE Item_Typeisnulland itemlike'%Controller%'

DeleteFROM tblildWHERE Item_Typeisnulland itemlike'%DETECTOR%'

DeleteFROM tblildWHERE Item_Typeisnulland itemlike'-%'

DeleteFROM tblildWHERE Item_Typeisnulland itemlike'sum%'

DeleteFROM tblildWHERE Item= Loop_Name

DeleteFROM tblildWHERE ITEMLIKE Loop_Name+'-%'and Item_Typeisnull

DeleteFROM tblildWHERE ITEMLIKE'[+]%'and Item_Typeisnull